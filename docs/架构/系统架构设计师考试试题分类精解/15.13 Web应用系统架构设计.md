<div class="detail lh2"><p>阅读以下关于Web应用系统架构设计的叙述，在答题纸上回答问题1至问题3。<br/>【说明】<br/>某信息技术公司计划开发一套在线投票系统，用于为市场调研、信息调查和销售反馈等业务提供服务。该系统计划通过大量宣传和奖品鼓励的方式快速积累用户，当用户规模扩大到一定程度时，开始联系相关企业提供信息服务，并按照信息服务种类和用户投票数量收取费用。<br/>为了降低开发成本和提高开发效率，项目组经过讨论后决定采用轻量级Java EE开发框架设计系统应用架构。在应用架构设计中，除了满足系统主要功能需求，还需要考虑的因素包括：<br/> （1）项目开发采用MySQL数据库存储数据，但将来可能移植到其他数据库平台；<br/> （2）系统开发过程中尽可能降低或者消除SQL语句开发的工作量；<br/> （3）投票系统中数据之间的关系复杂，需要支持数据对象的聚合和继承等关系。<br/> 项目组基于MVC模式设计出了投票系统的架构，包括表示层、业务逻辑层、数据持久层和数据层。在具体讨论数据持久层采用哪种技术方案时，老王建议采用成熟的Hibernate框架，小李则认为iBatis更加灵活，更适合作为投票系统数据持久层开发技术。<br/></p><br/><br/><p>【问题1】（5分）<br/>请用300以内文字说明什么是数据持久层，使用数据持久层能够为项目开发带来哪些好处？<br/>【问题2】（12分）<br/>针对在线投票系统的实际应用需求和要求，项目组应选用哪种技术实现数据持久层？请用200字以内文字说明其采用该技术的原因。<br/>【问题3】（8分）<br/></p><div>数据持久层是Web应用系统框架中重要的组成部分，主流的数据持久层技术分别基于不同的技术方案，请在表5-1中（1）-（4）处分别根据（a）~（d）所列技术的方案类别填入其序号。                   <br/><div style="text-align: center;">表5-1  数据持久层技术分类</div></div>
<div><div style="text-align: center;">    <img alt="" src="https://lstatic.xisaiwang.com/tiku/uploadfiles/2016-03/b7267d6ea4504ef688c1241de85f488a_.png" style="width: 401px; height: 148px;"/></div><p>（a） BMP，CMP<br/>（b）iBatis/MyBatis<br/>（c）Spring JdbcTemplate<br/>（d）TopLink，JDO，Hibernate<br/></p></div><br/><br/>答案<br/><p>【问题1】<br/>数据持久层是一组软件服务，将应用程序与该程序所使用的数据源分离，为整个项目提供一个统一、安全、并发的数据持久机制。<br/>好处：
</p><p>1、程序代码重用性强，即使更换数据库，只需要更改配置文件，不必重写程序代码。<br/>2、业务逻辑代码可读性强，在代码中不会有大量的SQL语言，提高程序的可读性。<br/>3、持久化技术可以自动优化，以减少对数据库的访问量，提高程序运行效率。<br/>4、简化开发工作，让开发人员更关注于业务逻辑的开发。<br/>5、通过对象/关系映射向业务逻辑提供面向对象的数据访问。<br/>6、分离业务逻辑层和数据层，降低两者之间的耦合。</p><p>【问题2】<br/>1、项目组应选Hibernate框架<br/>2、选择该技术的原因是：<br/>（1）从移植的角度来看使用Hibernate更容易移植到其他数据库平台。<br/>Hibernate与具体数据库的关联只需在XML文件中配置即可，所有的HQL语句与具体使用的数据库无关，移植性很好。MyBatis项目中所有的SQL语句都是依赖所用的数据库的，所以不同数据库类型的支持不好。<br/>（2）使用Hibernate能降低或者消除SQL语句开发工作量， Hibernate 提供了方法完成持久层操作，程序员不需要对SQL 的熟练掌握，便可完成任务。<br/>（3）Hibernate提供了对象状态管理的功能，使开发者不再需要理会底层数据库系统的细节，而MyBatis在这一块没有文档说明，用户需要对对象自己进行详细的管理。<br/>【问题3】<br/>（1） （c） <br/>（2） （b） <br/>（3） （d） <br/>（4） （a）<br/></p><br/><br/>试题分析<br/><p>iBatis 是apache 的一个开源项目，一个O/R Mapping 解决方案，iBatis 最大的特点就是小巧，上手很快。如果不需要太多复杂的功能，iBatis 是能够满足你的要求又足够灵活的最简单的解决方案，现在的iBatis 已经改名为Mybatis 了。<br/> EJB有两种主要类型BMP（Bean managed persistence ）和CMP（Container managed persistence ），这两种类型各有优缺点。<br/>BMP是在Bean中完成对数据库JDBC的各种调用，也就是说，在你的实体bean（entity bean）中，明确写入了SQL语句，如“insert .. ”或“select ..”，并且使用Datasource获得一个数据库资源以及连接（connection）从而对数据库直接进行增加删除修改。<br/>CMP是由EJB容器自动完成对数据库的操作，你所有做的，就是在实体bean重写入SetXXX或getXXX方法，然后在ejb-jar.xml中定义cmp-field就可以。<br/> Hibernate对数据库结构提供了较为完整的封装，Hibernate的O/R Mapping实现了POJO 和数据库表之间的映射，以及SQL 的自动生成和执行。程序员往往只需定义好了POJO 到数据库表的映射关系，即可通过Hibernate 提供的方法完成持久层操作。程序员甚至不需要对SQL 的熟练掌握， Hibernate/OJB 会根据制定的存储逻辑，自动生成对应的SQL 并调用JDBC 接口加以执行。<br/> iBATIS 的着力点，则在于POJO 与SQL之间的映射关系。然后通过映射配置文件，将SQL所需的参数，以及返回的结果字段映射到指定POJO。相对Hibernate“O/R”而言，iBATIS 是一种“Sql Mapping”的ORM实现。<br/> Hibernate的调优方案<br/>制定合理的缓存策略；<br/>尽量使用延迟加载特性；<br/>采用合理的Session管理机制；<br/>使用批量抓取，设定合理的批处理参数（batch_size）；<br/>进行合理的O/R映射设计<br/>Mybatis调优方案<br/>MyBatis在Session方面和Hibernate的Session生命周期是一致的，同样需要合理的Session管理机制。MyBatis同样具有二级缓存机制。 MyBatis可以进行详细的SQL优化设计。<br/> SQL优化方面<br/>Hibernate的查询会将表中的所有字段查询出来，这一点会有性能消耗。Hibernate也可以自己写SQL来指定需要查询的字段，但这样就破坏了Hibernate开发的简洁性。而Mybatis的SQL是手动编写的，所以可以按需求指定查询的字段。<br/> Hibernate HQL语句的调优需要将SQL打印出来，而Hibernate的SQL被很多人嫌弃因为太丑了。MyBatis的SQL是自己手动写的所以调整方便。但Hibernate具有自己的日志统计。Mybatis本身不带日志统计，使用Log4j进行日志记录。<br/> 扩展性方面<br/>Hibernate与具体数据库的关联只需在XML文件中配置即可，所有的HQL语句与具体使用的数据库无关，移植性很好。MyBatis项目中所有的SQL语句都是依赖所用的数据库的，所以不同数据库类型的支持不好。<br/> 对象管理<br/>Hibernate 是完整的对象/关系映射解决方案，它提供了对象状态管理（state management）的功能，使开发者不再需要理会底层数据库系统的细节。也就是说，相对于常见的 JDBC/SQL 持久层方案中需要管理 SQL 语句，Hibernate采用了更自然的面向对象的视角来持久化 Java 应用中的数据。<br/> 换句话说，使用 Hibernate 的开发者应该总是关注对象的状态（state），不必考虑 SQL 语句的执行。这部分细节已经由 Hibernate 掌管妥当，只有开发者在进行系统性能调优的时候才需要进行了解。<br/> 而MyBatis在这一块没有文档说明，用户需要对对象自己进行详细的管理。<br/> 抓取策略<br/>Hibernate对实体关联对象的抓取有着良好的机制。对于每一个关联关系都可以详细地设置是否延迟加载，并且提供关联抓取、查询抓取、子查询抓取、批量抓取四种模式。它是详细配置和处理的。<br/>而Mybatis的延迟加载是全局配置的。<br/></p></div>