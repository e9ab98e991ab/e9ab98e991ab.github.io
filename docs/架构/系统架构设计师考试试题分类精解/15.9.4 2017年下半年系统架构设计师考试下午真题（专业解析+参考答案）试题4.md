<div class="detail lh2"><p>阅读以下关于数据库设计的叙述，在答题纸上回答问题 1至问题 3。<br/>【说明】<br/>某制造企业为拓展网上销售业务，委托某软件企业开发一套电子商务网站。初期仅解决基本的网上销售、订单等功能需求。该软件企业很快决定基于.NET平台和SQL Server数据库进行开发，但在数据库访问方式上出现了争议。王工认为应该采用程序在线访问的方式访问数据库；而李工认为本企业内部程序员缺乏数据库开发经验，而且应用简单，应该采用 ORM （对象关系映射）方式。最终经过综合考虑，该软件企业采用了李工的建议。<br/>随着业务的发展，该电子商务网站逐渐发展成一个通用的电子商务平台，销售多家制造企业的产品，电子商务平台的功能也日益复杂。目前急需对该电子商务网站进行改造，以支持对多种异构数据库平台的数据访问，同时满足复杂的数据管理需求。该软件企业针对上述需求，对电子商务网站的架构进行了重新设计，新增加了数据访问层，同时采用工厂设计模式解决异构数据库访问的问题。新设计的系统架构如图 4-1所示。<br/></p>
<div style="text-align: center;"><img alt="" src="https://lstatic.xisaiwang.com/tiku/uploadfiles/2017-11/183472bd47794bf299b9b4e7d099a2db_.png" style="width: 515px; height: 346px;"/></div><p style="text-align: center;">图 4-1 电子商务网站的体系结构<br/></p><br/><br/><p>【问题 1】 （9分）<br/>请用300字以内的文字分别说明数据库程序在线访问方式和ORM方式的优缺点，说明该软件企业采用ORM的原因。<br/>【问题2】 （9分）<br/>请用100宇以内的文字说明新体系架构中增加数据访问层的原因。请根据图4-1所示，填写图中空白处（1）-（3）。<br/>【问题3】 （7分） <br/>应用程序设计中，数据库访问需要良好的封装性和可维护性，因此经常使用工厂设计模式来实现对数据库访问的封装。请解释工厂设计模式，并说明其优点和应用场景；请解释说明工厂模式在数据访问层中的应用。<br/></p><br/><br/>答案<br/>【问题1】<br/>
数据库程序在线访问方式优点：<br/>
1、性能比ORM好<br/>
2、可以处理复杂查询语句<br/>
数据库程序在线访问方式缺点：<br/>
1、要求程序员懂SQL语句<br/>
2、修改与维护相对困难<br/>
ORM优点：<br/>
1、使用ORM可以大大降低学习和开发成本。<br/>
2、程序员不用再写SQL来进行数据库操作。<br/>
3、减少程序的代码量。<br/>
4、降低由于SQL代码质量差而带来的影响。<br/>
ORM缺点：<br/>
1、不太容易处理复杂查询语句。<br/>
2、性能较直接用SQL差。<br/>
本题中的场景之所以选择ORM，主要考虑的是程序员缺乏数据库开发经验，这样SQL语句质量有很大风险。同时学习成本很高。此外应用简单，不用担心ORM对性能的影响。<br/>
【问题2】<br/>
增加数据访问层的原因：<br/>
（1）由于涉及到多种异构数据库平台，数据访问复杂性增加，不宜与业务逻辑混合在一起。<br/>
（2）数据管理变复杂之后，需要使用的代码量增加，分单独层次有利于让逻辑更清晰。<br/>
（3）业务逻辑应以相同的方式应对异构的数据库，此时需要单独的数据访问层屏蔽差异性。<br/>1）执行业务逻辑/业务组件/业务构件       2）数据访问接口层/DAL接口       3）工厂层/DAL工厂/数据访问工厂 <br/>
【问题3】<br/>
工厂模式分抽象工厂与工厂方法，题目中的场景适合采用抽象工厂设计模式。<br/>
抽象工厂设计模式提供一个接口，可以创建一系列相关或相互依赖的对象，而无需指定它们具体的类。其优点是可以非常方便地创建一系列的对象，其使用场景也是创建系列对象的情况。在本题中，可以针对Oracle、MySQL、SQLServer分别建立抽象工厂，若指定当前工厂为Oracle工厂，则创建出来的数据库连接，数据集等一系列的对象都是符合Oracle操作要求的。这样便于数据库之间的切换。<br/><br/><br/>试题分析<br/><div>【问题1】<br/>
</div><div>ORM，即Object-Relationl Mapping，它在关系型数据库和对象之间作一个映射，这样，我们在具体的操作数据库的时候，就不需要再去和复杂的SQL语句打交道，只要像平时操作对象一样操作即可。</div>
当你开发一个应用程序的时候（不使用OR Mapping），可能会涉及许多数据访问层的代码，用来从数据库保存、删除、读取对象信息等等，然而这些代码写起来总是重复的。<br/>
一个更好的办法就是引入OR Mapping。实质上，一个OR Mapping会为你生成DAL。与其自己写DAL代码，不如用OR Mapping，你只需要关心对象就好。<br/>
使用ORM可以大大降低学习和开发成本。而在实际的开发中，真正对客户有价值的是其独特的业务功能，而不应该把大量时间花费在编写数据访问、CRUD方法、后期的Bug查找和维护上。在使用ORM之后，ORM框架已经把数据库转变成了我们熟悉的对象，我们将只需要了解面向对象开发就可以实现数据库应用程序的开发，不需要浪费时间在SQL上。同时也可减少代码量，减少数据层出错机会。<br/><div>
通过Cache的实现，能够对性能进行调优，实现了ORM区隔了实际数据存储和业务层之间的关系，能够对每一层进行单独跟踪，增加了性能优化的可能。</div><div>【问题2】<br/></div><div>数据在线访问模式提高了数据访问的性能，但同时导致了业务逻辑层与数据访问的职责混乱，一旦要求支持的数据库发生变化，或者需要修改数据访问的逻辑，由于没有清晰的分层，会导致项目做大的修改。而随着硬件系统性能的提高，以及充分利用缓存、异步处理等机制，分层式结构所带来的性能影响可以忽略不计。<br/></div><div>根据题干说明，新的电子商务平台业务复杂，而且需要访问异构的数据源，也就是说需要访问不同类型的数据库。因此，需要增加新的数据库访问层来封装对数据库的访问，使得在应用程序设计时，不会因为数据库种类的不同而受到影响，尽量做到数据库无关。<br/></div><div>【问题3】</div><div>在应用程序设计中，需要对数据库访问进行良好的封装，使其具有良好的可维护性，尽量使得应用程序与数据库无关。本题中，应用系统需要访问异构数据源，在应用程序中会存在多种数据访问接口。因此在实际开发中，需要对这些访问接口再做一次封装，这样可以减少操作数据库的步骤，减少代码编写量。工厂设计模式是使用的主要方法。工厂设计模式定义了创建对象的接口，允许子类决定实例化哪个类，而且允许请求者无须知道要被实例化的特定类，这样可以在不修改代码的情况下引入新类。优点是：没有了将应用程序类绑定到代码中的要求，可以使用任何实现了接口的类；允许子类提供对象的扩展版本。工厂设计模式的应用场景有：类不能预料它必须创建的对象的类，类希望其子类指定它要创建的对象。在数据访问层定义采用工厂模式，定义统一的操纵数据库的接口，然后根据数据库的不同，由类工厂来决定实例化哪个类。在具体类中实现特定的数据库访问类。这样，就可以实现主客户端指定或根据配置文来选择访问不同的数据库，从而实现应用程序与数据库无关。 <br/></div></div>